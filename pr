WITH Duplicates AS (
    SELECT *,
           ROW_NUMBER() OVER (
               PARTITION BY legacyId
               ORDER BY Id ASC
           ) AS rn
    FROM dbo.CustomerTags
)
DELETE FROM Duplicates
WHERE rn > 1;
