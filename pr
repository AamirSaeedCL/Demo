SELECT
    COALESCE(s.LegacyId, d.LegacyId) AS LegacyId,
    *
FROM stg.CustomerTags s
FULL OUTER JOIN dbo.CustomerTags d
    ON s.LegacyId = d.LegacyId
WHERE
    -- Find rows that exist only in one table
    s.LegacyId IS NULL
    OR d.LegacyId IS NULL
    -- Or any column values differ
    OR ISNULL(s.CustomerId, '') <> ISNULL(d.CustomerId, '')
    OR ISNULL(s.CustomerGroupId, '') <> ISNULL(d.CustomerGroupId, '')
    OR ISNULL(s.DDTag, '') <> ISNULL(d.DDTag, '')
    OR ISNULL(s.DateDDAssigned, '') <> ISNULL(d.DateDDAssigned, '')
    OR ISNULL(s.DateDDRemoved, '') <> ISNULL(d.DateDDRemoved, '')
    OR ISNULL(s.DDActive, '') <> ISNULL(d.DDActive, '')
    OR ISNULL(s.DialTag, '') <> ISNULL(d.DialTag, '')
    OR ISNULL(s.DateDialAssigned, '') <> ISNULL(d.DateDialAssigned, '')
    OR ISNULL(s.DateDialRemoved, '') <> ISNULL(d.DateDialRemoved, '')
    OR ISNULL(s.DialActive, '') <> ISNULL(d.DialActive, '')
    OR ISNULL(s.DigitalTag, '') <> ISNULL(d.DigitalTag, '')
    OR ISNULL(s.DateDigitalAssigned, '') <> ISNULL(d.DateDigitalAssigned, '')
    OR ISNULL(s.DateDigitalRemoved, '') <> ISNULL(d.DateDigitalRemoved, '')
    OR ISNULL(s.DigitalActive, '') <> ISNULL(d.DigitalActive, '')
    OR ISNULL(s.PayerPhaseTag, '') <> ISNULL(d.PayerPhaseTag, '')
    OR ISNULL(s.DatePayerPhaseAssigned, '') <> ISNULL(d.DatePayerPhaseAssigned, '')
    OR ISNULL(s.DatePayerPhaseRemoved, '') <> ISNULL(d.DatePayerPhaseRemoved, '')
    OR ISNULL(s.PayerPhaseActive, '') <> ISNULL(d.PayerPhaseActive, '')
    OR ISNULL(s.PhaseTag, '') <> ISNULL(d.PhaseTag, '')
    OR ISNULL(s.DatePhaseAssigned, '') <> ISNULL(d.DatePhaseAssigned, '')
    OR ISNULL(s.DatePhaseRemoved, '') <> ISNULL(d.DatePhaseRemoved, '')
    OR ISNULL(s.PhaseActive, '') <> ISNULL(d.PhaseActive, '')
    OR ISNULL(s.PlanTag, '') <> ISNULL(d.PlanTag, '')
    OR ISNULL(s.DatePlanAssigned, '') <> ISNULL(d.DatePlanAssigned, '')
    OR ISNULL(s.DatePlanRemoved, '') <> ISNULL(d.DatePlanRemoved, '')
    OR ISNULL(s.PlanActive, '') <> ISNULL(d.PlanActive, '')
    OR ISNULL(s.PreDefTag, '') <> ISNULL(d.PreDefTag, '')
    OR ISNULL(s.DatePreDefAssigned, '') <> ISNULL(d.DatePreDefAssigned, '')
    OR ISNULL(s.DatePreDefRemoved, '') <> ISNULL(d.DatePreDefRemoved, '')
    OR ISNULL(s.PreDefActive, '') <> ISNULL(d.PreDefActive, '')
    OR ISNULL(s.RemediationTag, '') <> ISNULL(d.RemediationTag, '')
    OR ISNULL(s.DateRemediationAssigned, '') <> ISNULL(d.DateRemediationAssigned, '')
    OR ISNULL(s.DateRemediationRemoved, '') <> ISNULL(d.DateRemediationRemoved, '')
    OR ISNULL(s.RemediationActive, '') <> ISNULL(d.RemediationActive, '')
    OR ISNULL(s.SMSTag, '') <> ISNULL(d.SMSTag, '')
    OR ISNULL(s.DateSMSAssigned, '') <> ISNULL(d.DateSMSAssigned, '')
    OR ISNULL(s.DateSMSRemoved, '') <> ISNULL(d.DateSMSRemoved, '')
    OR ISNULL(s.SMSActive, '') <> ISNULL(d.SMSActive, '')
    OR ISNULL(s.StatusTag, '') <> ISNULL(d.StatusTag, '')
    OR ISNULL(s.DateStatusAssigned, '') <> ISNULL(d.DateStatusAssigned, '')
    OR ISNULL(s.DateStatusRemoved, '') <> ISNULL(d.DateStatusRemoved, '')
    OR ISNULL(s.StatusActive, '') <> ISNULL(d.StatusActive, '')
    OR ISNULL(s.PreviousStatusTag, '') <> ISNULL(d.PreviousStatusTag, '')
    OR ISNULL(s.DatePreviousStatusAssigned, '') <> ISNULL(d.DatePreviousStatusAssigned, '')
    OR ISNULL(s.DatePreviousStatusRemoved, '') <> ISNULL(d.DatePreviousStatusRemoved, '')
    OR ISNULL(s.PreviousStatusActive, '') <> ISNULL(d.PreviousStatusActive, '')
    OR ISNULL(s.UpsertDateTime, '') <> ISNULL(d.UpsertDateTime, '');
