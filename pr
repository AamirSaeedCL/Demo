[TestMethod]
public void Dispose_TimerServiceThrowsException_LogsErrorAndThrows()
{
    // Arrange
    _timerServiceMock.Setup(t => t.Dispose()).Throws(new InvalidOperationException());

    try
    {
        // Act
        _worker.Dispose();
    }
    catch (InvalidOperationException ex)
    {
        // Assert - Ensure the logger logs the error
         _loggerMock.Verify(
       logger => logger.LogError(
           It.Is<Exception>(ex => ex is InvalidOperationException),
           It.IsAny<string>()),
       Times.Once);
    }
}


System.NotSupportedException: 'Unsupported expression: logger => logger.LogError(It.Is<Exception>(ex => ex is InvalidOperationException), It.IsAny<string>(), new[] {  })
Extension methods (here: LoggerExtensions.LogError) may not be used in setup / verification expressions.'
