DECLARE 
    @ValidPhoneTypes VARCHAR(50) = '0, 1, 3',  -- UNKNOWN, HOME, CELL
    @ValidPhoneStatus VARCHAR(50) = '0, 1, 3', -- UNKNOWN, VALID, NEW
    @SoftDeleteFlag CHAR(1) = 'N',
    @MobilePrefix VARCHAR(2) = '07',
    @ExpectedPhoneLength INT = 11;

-- CDC operation constants
DECLARE @CDC_OP_INSERT INT = 2;
DECLARE @CDC_OP_UPDATE_AFTER INT = 4;

SELECT  DISTINCT cnsmr_id
    FROM [dbo].[cnsmr_Phn] p
    WHERE  
	    p.cnsmr_phn_typ_cd IN (SELECT value FROM STRING_SPLIT(@ValidPhoneTypes, ','))
      AND p.cnsmr_phn_stts_cd IN (SELECT value FROM STRING_SPLIT(@ValidPhoneStatus, ','))
      AND p.cnsmr_phn_sft_dlt_flg = @SoftDeleteFlag
      AND LEFT(p.cnsmr_phn_nmbr_txt, 2) = @MobilePrefix
      AND LEN(p.cnsmr_phn_nmbr_txt) = @ExpectedPhoneLength
	  AND cnsmr_id IN (Select DISTINCT cnsmr_id from [cdc].[dbo_cnsmr_Phn_CT] WHERE [__$operation] IN (@CDC_OP_INSERT, @CDC_OP_UPDATE_AFTER))
	  AND cnsmr_id = '1645735'
