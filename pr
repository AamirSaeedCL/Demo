I have removed the Consumer Master table from the primary query paths during the ETL process in order to reduce query complexity and significantly improve data retrieval performance and execution speed.

As a result of this change, when inserting records into the staging (stg) table, the LegacyId column must be explicitly set to NULL, as this value is no longer sourced at that stage of the pipeline. The staging schema has been designed to allow LegacyId to be nullable to support this intermediate state.

Subsequently, during the dataflow transformation phase—when data is promoted from the staging (stg) layer to the dbo/sbo layer—the CustomerGroupId is updated based on the relevant business logic. At the same time, the LegacyId is populated and persisted in the target dbo table.

Please note that the LegacyId column is non-nullable in the dbo table by design. Null values are permitted only within the staging layer and are fully resolved before data is committed to the final schema.
