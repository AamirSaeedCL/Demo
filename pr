CREATE PROCEDURE UpdateCustomerGroupId
AS
BEGIN
    -- Start the transaction
    BEGIN TRY
        BEGIN TRANSACTION;

        -- Update statement
        UPDATE c
        SET c.customergroupid = cg.groupId
        FROM dbo.Customer c
        INNER JOIN ConsumerGroup cg
            ON c.customerid = cg.consumerid;

        -- Commit the transaction
        COMMIT TRANSACTION;

        PRINT 'Update successful.';

    END TRY
    BEGIN CATCH
        -- If an error occurs, roll back the transaction
        IF @@TRANCOUNT > 0
            ROLLBACK TRANSACTION;

        -- Print error message
        DECLARE @ErrorMessage NVARCHAR(4000);
        SET @ErrorMessage = ERROR_MESSAGE();
        PRINT 'Error occurred: ' + @ErrorMessage;
    END CATCH;
END;
